<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8" />
        <title>Cool Simulation</title>
        <script
              src="https://code.jquery.com/jquery-3.7.1.min.js"
              integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
              crossorigin="anonymous"></script>
        <script>
            $(document).ready(function() {
                clearResults();
				resetDefaults();

                $("#make-results-button").click(function() {
					gatherInputs();
                    makeResults();
                });

                $("#reset-button").click(function() {
                    clearResults();
                });
				
				$("#reset-defaults-button").click(function() {
					resetDefaults();
				});
            });
			
			var SimData = {
				P0: {x:0, y:0},
				P1: {x:0, y:0},
				P2: {x:0, y:0},
				P3: {x:0, y:0},
				NumSlices: 0
			};
			
			function resetDefaults()
			{
				SimData.P0 = {x:0, y:0};
				SimData.P1 = {x:3, y:9};
				SimData.P2 = {x:6, y:10};
				SimData.P3 = {x:10, y:10};
				SimData.NumSlices = 10;
				
				$("#input-p0-x").val(SimData.P0.x);
				$("#input-p0-y").val(SimData.P0.y);
				$("#input-p1-x").val(SimData.P1.x);
				$("#input-p1-y").val(SimData.P1.y);
				$("#input-p2-x").val(SimData.P2.x);
				$("#input-p2-y").val(SimData.P2.y);
				$("#input-p3-x").val(SimData.P3.x);
				$("#input-p3-y").val(SimData.P3.y);
				$("#input-num-slices").val(SimData.NumSlices);
			}
			
			function gatherInputs()
			{
				SimData.P0.x = Number($("#input-p0-x").val());
				SimData.P0.y = Number($("#input-p0-y").val());
				SimData.P1.x = Number($("#input-p1-x").val());
				SimData.P1.y = Number($("#input-p1-y").val());
				SimData.P2.x = Number($("#input-p2-x").val());
				SimData.P2.y = Number($("#input-p2-y").val());
				SimData.P3.x = Number($("#input-p3-x").val());
				SimData.P3.y = Number($("#input-p3-y").val());
				SimData.NumSlices = Number($("#input-num-slices").val());
			}

            function calculatePointOnCurve(t)
            {
                // B(t) = (1−t)^3*P0 + 3*(1−t)^2*t*P1 + 3*(1−t)*t^2*P2 + t^3*P3 where 0≤t≤1
                // P0, P1, P2, and P3 are the control points for the curve

                if(t === 0) {
                    return SimData.P0;
                }

                var invT = (1 - t);

                var p0result = {x:0, y:0};
                var p1result = {x:0, y:0};
                var p2result = {x:0, y:0};
                var p3result = {x:0, y:0};

                // remember, quick-and-dirty... this math is not optimized ;)

                p0result.x = Math.pow(invT, 3) * SimData.P0.x;
                p0result.y = Math.pow(invT, 3) * SimData.P0.y;

                p1result.x = 3 * Math.pow(invT, 2) * t * SimData.P1.x;
                p1result.y = 3 * Math.pow(invT, 2) * t * SimData.P1.y;

                p2result.x = 3 * invT * Math.pow(t, 2) * SimData.P2.x;
                p2result.y = 3 * invT * Math.pow(t, 2) * SimData.P2.y;

                p3result.x = Math.pow(t, 3) * SimData.P3.x;
                p3result.y = Math.pow(t, 3) * SimData.P3.y;

                return {x: p0result.x + p1result.x + p2result.x + p3result.x, y: p0result.y + p1result.y + p2result.y + p3result.y};
            }

            function makeResults()
            {
				var output = "<div class='top-bot-space-small'><h2>Results</h2></div>";
                output += "<table border='1'><tr><th>Slice</th><th>x</th><th>y</th></tr>";
                for(var slice = 0; slice <= SimData.NumSlices; ++slice) {
                    var val = calculatePointOnCurve(slice / SimData.NumSlices);
                    output += "<tr><td>" + slice + "</td><td>" + val.x + "</td><td>" + val.y + "</td></tr>";
                }
                output += "</table>";

                $("#results-output").html(output);
                $("#results-area").show();
            }

            function clearResults()
            {
                $("#results-area").hide();
                $("#results-output").html("");
				resetDefaults();
            }
        </script>
        <style>
            #results-area {
                margin-top: 50px;
            }

            table {
                border: 1px;
                border-collapse: collapse;

                th {
                    padding: 5px;
                }

                td {
                    padding: 5px;
                }
            }
			
			.top-bot-space-small {
				margin: 10px 0 10px 0;
			}
        </style>
    </head>
    <body>
        <h1>Super Cool Simulation</h1>

        <div id="setup-data">
			<table border='1'>
				<tr>
					<th>Control Point</th>
					<th>x</th>
					<th>y</th>
				</tr>
				<tr>
					<td>P0</td>
					<td><input type="text" id="input-p0-x" /></td>
					<td><input type="text" id="input-p0-y" /></td>
				</tr>
				<tr>
					<td>P1</td>
					<td><input type="text" id="input-p1-x" /></td>
					<td><input type="text" id="input-p1-y" /></td>
				</tr>
				<tr>
					<td>P2</td>
					<td><input type="text" id="input-p2-x" /></td>
					<td><input type="text" id="input-p2-y" /></td>
				</tr>
				<tr>
					<td>P3</td>
					<td><input type="text" id="input-p3-x" /></td>
					<td><input type="text" id="input-p3-y" /></td>
				</tr>
			</table>
			<div class="top-bot-space-small"><label>Number of Slices:</label> <input type="text" id="input-num-slices" /></div>
			<div class="top-bot-space-small"><button type="button" id="make-results-button">Calculate</button> <button type="button" id="reset-defaults-button">Defaults</button></div>
		</div>

        <div id="results-area">
            <div id="results-output"></div>
            <div class="top-bot-space-small"><button type="button" id="reset-button">Reset</button></div>
        </div>
    </body>
</html>
